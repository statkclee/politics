# 데이터 과학자와 함께 하는 제19대 대통령 선거



## 왜 독일식 비례대표제인가? [^hani-2014] 

지역구 의원(253명)을 선출하고 나서 비례국회의원(47명)을 선출하여 300명을 채우는 
현재 선거제도는 다음과 같은 문제점을 지속적으로 야기하고 있는 것으로 밝혀졌다.

- 인구대비 국회의원 수가 OECD 소속국가 기준으로 봤을 때 너무 적다.
- 각 정당을 대표하여 출마한 국회의원의 득표율과 각 정당별 의석수에 괴리가 심각하다.


[^hani-2014]: [19대 총선에 ‘독일식 비례대표제’ 적용해보니 양당 구도 흔들](http://www.hani.co.kr/arti/politics/assembly/664754.html)

[^slownes-2012]: [19대 총선에 독일식 정당명부제를 도입했다면, 특집](http://slownews.kr/2387)

<img src="fig/19대_총선.jpg" alt="독일식 선거제도 도입 19대 총선" width="57%" />

## 국내 총선제도와 독일식 정당명부제 비교 [^slownes-2012]

국내 총선제도는 현재 이원화 투표를 통해 지역구 후보선출과 전국정당지지를 혼합한 형태다.
독일식 정당명부제 투표는 정당지지율에 기반하여 각 지역의 정당별 확보의석을 지정하는 방식이다.

<img src="fig/election_system_comparison.png" alt="국내 총선제도와 독일식 비례대표제 비교" width="47%" />

## 20대 총선 

20대 총선을 통해 살펴본 지역구 투표율 분석을 통해 국회의원수 불일치 문제를 데이터를 통해 확인히 살펴볼 수 있다.
즉, 거대정당 새누리당과 더불어민주당은 실제 득표율보다 높은 의석수를 점하고, 소수정당인 국민의당, 정의당 등은 
실제 극표율보다 낮은 의석수를 갖게되어 소선구제 투표제도하에서는 제도적으로 양대 거대 정당의 출현이 반복되고 있지만,
촛불 민의는 그 이전에도 다당제를 선호하는 방식으로 표출되었다.

### 20대 총선 데이터

중앙선거관리위원회 [분야별 정보 > 선거정보 > 자료실](http://www.nec.go.kr/portal/bbs/list/B0000338.do?menuNo=200061)에서 
제20대 국회의원선거 투표구별 개표결과 자료를 다운로드 받는다. 제20대 국회의원선거 정당별 득표수 현황(지역구 기준)도 제공되어 
엑셀 파일을 데이터프레임으로 변환한 결과가 맞는지 사전 검정하는 것도 데이터 정합성 확보를 위해 상호 검정한다.


~~~{.r}
# 0. 환경설정-------------------------------------------
library(tidyverse)
library(readxl)
library(RColorBrewer)
library(scales)
library(stringr)

# 1. 엑셀 --> 데이터프레임 변환 -------------------------------------------
# http://stackoverflow.com/questions/28549045/dplyr-select-error-found-duplicated-column-name
read_19_xlsx <- function(filename){
  temp <- read_excel(path = filename, skip=4)
  names(temp)[c(1:4, 16:17)] <-  c("읍면동명", "투표구명", "선거인수", "투표수", "무효\n투표수", "기권수")
  temp <- temp[, str_detect(names(temp), "^(?!\n)")] %>% slice(1)
  names(temp) <- str_replace_all(names(temp), "\n(.*)", "")
  valid_column_names <- make.names(names=names(temp), unique=TRUE, allow_ = TRUE)
  names(temp) <- valid_column_names
  temp <- temp %>% mutate_each(funs(gsub(",", "", .)), 선거인수:기권수) %>% 
    mutate_each(funs(as.numeric(.)), 선거인수:기권수)
  temp$무당파 <- rowSums(temp[, grepl("무소속", colnames(temp))])
  temp <- temp[, names(temp) %in% c("선거인수", "투표수", "새누리당", "민주통합당", "자유선진당", "통합진보당", "창조한국당", "국민생각", "대국민중심당", "국가재건친박연합", "국민행복당", "기독당", "녹색당", "대한국당", "미래연합", "불교연합당", "정통민주당", "진보신당", "청년당", "한국기독당", "한국문화예술당", "한나라당", "무당파")]
  return(temp)
}

read_20_xlsx <- function(filename){
  temp <- read_excel(path = filename, skip=4)
  names(temp)[c(1:4, 27:28)] <-  c("읍면동명", "투표구명", "선거인수", "투표수", "무효\n투표수", "기권수")
  valid_column_names <- make.names(names=names(temp), unique=TRUE, allow_ = TRUE)
  names(temp) <- valid_column_names
  temp <- temp[, str_detect(names(temp), "^(?!NA)")] %>% slice(2)
  temp$무당파 <- rowSums(temp[, grepl("무소속", colnames(temp))])
  names(temp) <- str_replace_all(names(temp), "\\..(.*)", "")  
  temp <- temp[, names(temp) %in% c("선거인수", "투표수", "새누리당", "더불어민주당", "국민의당", "정의당", "기독자유당", "민주당", "가자코리아", "일제·위안부·인권정당", "개혁국민신당", "고용복지연금선진화연대", "공화당", "그린불교연합당", "기독민주당", "노동당", "녹색당", "민중연합당", "복지국가당", "친반통일당", "통일한국당", "한국국민당", "한나라당", "무당파")]
}


dir_name <- list.files("data/제20대 국회의원선거 투표구별 개표결과/지역구/")

dir_file_lists <- list()

for(i in 1:length(dir_name)) {
  dir_file_lists[[i]] <- paste0("data/제20대 국회의원선거 투표구별 개표결과/지역구/", dir_name[i], "/",list.files(path=paste0("data/제20대 국회의원선거 투표구별 개표결과/지역구/", dir_name[i]), pattern="*.xlsx"))
  print(dir_file_lists[[i]])
}

# 리스트를 언리스트
dir_file_unlists <- unlist(dir_file_lists)

# 엑셀파일을 데이터프레임으로 변환
for (i in 1:length(dir_file_unlists)) {
  assign(dir_file_unlists[i], read_20_xlsx(dir_file_unlists[i]))
}

c_name <- list()
for(i in 1:length(dir_file_unlists)) {
  c_name[[i]] <- as.name(dir_file_unlists[i])
}

df_dat <- do.call(plyr::rbind.fill, c_name)
df_sigun <- as.data.frame(dir_file_unlists)

df <- bind_cols(df_sigun, df_dat)

# write_csv(df, "output/congressmen_20.csv")
~~~

### 소선구제와 독일식 비례대표제 기준 정당별 시각화

엑셀 파일을 데이터 프레임으로 저장한 후 엑셀로 일부 전처리를 한 후 파일을 불러 읽어 드리고 시각화한다.
소선구제와 독일식 비례대표제 기준으로 정당별 시각화한다. 
거대 양당은 득표율보다 많은 의석수를 갖고, 상대적으로 중소 정당은 높은 득표율을 갖고 있음에도 불구하고 
그에 걸맞지 못한 득표를 갖는 폐혜가 나타나고 있다.


~~~{.r}
# 1. 데이터 가져오기 -------------------------------------------

vote_20_df <- read_excel("data/제20대_총선_종합.xlsx", sheet="Sheet1") %>% dplyr::rename("무소속"=무당파, sido=시도)

# 2. 데이터 전처리 -------------------------------------------

vote_20_df <- vote_20_df %>% mutate(sido = str_replace_all(sido, "[0-9]", ""))

datatable(vote_20_df)
~~~

<!--html_preserve--><div id="htmlwidget-e6e314eb057da0b6000d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e6e314eb057da0b6000d">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326"],["강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","강원","충북","충북","충북","충북","충북","충북","충북","충북","충북","충북","충북","충북","충북","충북","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","충남","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전북","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","전남","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경북","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","경남","제주","제주","제주","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","서울","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","부산","대구","대구","대구","대구","대구","대구","대구","대구","대구","대구","대구","대구","대구","인천","인천","인천","인천","인천","인천","인천","인천","인천","인천","인천","인천","인천","인천","인천","인천","광주","광주","광주","광주","광주","광주","광주","광주","대전","대전","대전","대전","대전","대전","대전","울산","울산","울산","울산","울산","울산","세종","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기","경기"],["강릉시","고성군","동해시","삼척시","속초시","양구군","양양군","영월군","원주시갑","원주시을","인제군","정선군","철원군","춘천시","태백시","평창군","홍천군","화천군","횡성군","괴산군","단양군","보은군","영동군","옥천군","음성군","제천시","증평군","진천군","청주시상당구","청주시서원구","청주시청원구","청주시흥덕구","충주시","계룡시","공주시","금산군","논산시","당진시","보령시","부여군","서산시","서천군","아산시갑","아산시을","예산군","천안시갑","천안시병","천안시을","청양군","태안군","홍성군","고창군","군산시","김제시","남원시","무주군","부안군","순창군","완주군","익산시갑","익산시을","임실군","장수군","전주시갑","전주시병","전주시을","정읍시","진안군","강진군","고흥군","곡성군","광양시","구례군","나주시","담양군","목포시","무안군","보성군","순천시","신안군","여수시갑","여수시을","영광군","영암군","완도군","장성군","장흥군","진도군","함평군","해남군","화순군","경산시","경주시","고령군","구미시갑","구미시을","군위군","김천시","문경시","봉화군","상주시","성주군","안동시","영덕군","영양군","영주시","영천시","예천군","울릉군","울진군","의성군","청도군","청송군","칠곡군","포항시남구","포항시북구","거제시","거창군","김해시갑","김해시을","남해군","밀양시","사천시","산청군","양산시갑","양산시을","의령군","진주시갑","진주시을","창녕군","창원시마산합포구","창원시마산회원구","창원시성산구","창원시의창구","창원시진해구","하동군","함안군","함양군","합천군","서귀포시","제주시갑","제주시을","강남구갑","강남구병","강남구을","강동구갑","강동구을","강북구갑","강북구을","강서구갑","강서구병","강서구을","관악구갑","관악구을","광진구갑","광진구을","구로구갑","구로구을","금천구","노원구갑","노원구병","노원구을","도봉구갑","도봉구을","동대문구갑","동대문구을","동작구갑","동작구을","마포구갑","마포구을","서대문구갑","서대문구을","서초구갑","서초구을","성북구갑","성북구을","송파구갑","송파구병","송파구을","양천구갑","양천구을","영등포구갑","영등포구을","용산구","은평구갑","은평구을","종로구","중구성동갑","중구성동을","중랑구갑","중랑구을","금정구","기장군","남구갑","남구을","동래구","부산동구","부산서구","부산중구","부산진구갑","부산진구을","북구강서구갑","북구강서구을","사상구","사하구갑","사하구을","수영구","연제구","영도구","해운대구갑","해운대구을","달서구갑","달서구병","달서구을","달성군","대구남구","대구서구","대구중구","동구갑","동구을","북구갑","북구을","수성구갑","수성구을","강화군","계양구갑","계양구을","남구갑","남구을","남동구갑","남동구을","부평구갑","부평구을","서구갑","서구을","연수구갑","연수구을","옹진군","인천동구","인천중구","광산구갑","광산구을","동구남구갑","동구남구을","북구갑","북구을","서구갑","서구을","대덕구","동구","서구갑","서구을","유성구갑","유성구을","중구","남구갑","남구을","동구","북구","울주군","중구","세종특별자치시","가평군","고양시갑","고양시병","고양시을","고양시정","과천시","광명시갑","광명시을","광주시갑","광주시을","구리시","군포시갑","군포시을","김포시갑","김포시을","남양주시갑","남양주시병","남양주시을","동두천시","부천시소사구","부천시오정구","부천시원미구갑","부천시원미구을","성남시분당구갑","성남시분당구을","성남시수정구","성남시중원구","수원시갑","수원시무","수원시병","수원시을","수원시정","시흥시갑","시흥시을","안산시단원구갑","안산시단원구을","안산시상록구갑","안산시상록구을","안성시","안양시동안구갑","안양시동안구을","안양시만안구","양주시","양평군","여주시","연천군","오산시","용인시갑","용인시병","용인시을","용인시정","의왕시","의정부시갑","의정부시을","이천시","파주시갑","파주시을","평택시갑","평택시을","포천시","하남시","화성시갑","화성시병","화성시을"],[177335,25713,75987,59454,67138,19564,23733,34677,133866,134305,27464,33729,40165,226260,39462,37313,59348,22462,39360,34172,26703,29875,43425,44746,80220,112534,29530,55336,140850,173705,144497,200247,171049,31212,93869,46827,103948,132562,87410,61273,135389,49403,118823,112841,71531,168194,138233,170020,28187,54647,78649,50860,223265,76021,70142,21613,48787,25294,77555,117792,126840,25863,19942,148951,199146,168230,96330,22598,32725,60581,26777,119006,23494,83834,41078,187494,65384,39240,220553,38737,119921,115348,47300,47848,45127,39051,35492,27711,30249,64065,54551,210959,217306,29860,177059,148842,22037,117499,63964,29662,87504,39791,139956,34734,15756,91789,86940,39491,8943,43691,49403,39164,23685,97667,201050,220958,196374,52616,222541,185900,40388,92464,93990,31732,118303,121860,25082,146372,131180,55001,153360,173197,184105,208050,144405,43421,56849,34512,42957,135767,190415,171373,168266,152297,153093,201350,178386,140892,141334,172316,157029,163533,235005,211095,152431,153205,197751,154871,202232,140642,159717,167383,142823,151799,160115,148013,179604,161781,136193,190675,127642,140912,161632,200087,201457,182174,167295,207439,166803,202343,187779,176855,146636,200224,209352,206494,134507,189620,172600,160283,192315,209696,119624,119638,116576,227516,80890,100840,40751,165569,160350,146182,191127,200808,123247,156920,154956,177058,112377,185677,160777,148145,140857,193782,157259,139427,177712,70174,132976,159280,159345,193685,200586,156901,59151,128572,143927,168229,171691,210708,217648,235228,222693,210214,186131,133338,119224,18462,60264,92755,132298,165038,134017,127632,158844,198674,118421,123297,158903,196330,198407,193145,131617,126412,209037,150440,126735,140366,145738,174359,199153,167748,52891,224395,225454,159645,218257,55845,128477,146728,122751,129583,150590,114374,115135,140224,133179,154956,178679,182248,79882,184100,152131,143513,219314,205625,195260,189821,210248,202592,207928,166543,186350,181891,163569,150399,142137,111876,170819,133333,145177,145432,134712,207248,162317,91717,91746,38726,157509,177955,203725,171818,200235,127832,171694,182164,162667,180095,153624,148674,218106,128228,141223,154256,166886,133633],[96633,15062,44162,35972,33324,12009,14121,21635,73141,77663,16579,20384,23149,133803,22388,22622,36949,13965,23197,17711,16096,19685,27664,28809,42010,63365,15618,34951,82936,103816,82627,110362,91439,19538,55591,26148,59738,71506,52427,35206,74809,30399,62477,60633,40672,81872,77955,90795,17054,32203,45204,32476,129733,47967,48136,14796,29862,17369,50271,71826,75412,16966,13699,91320,130233,110138,59993,15610,21716,42186,17514,74778,16055,55174,26169,105058,44131,25456,151778,25688,71980,68679,29268,30106,31159,24255,22598,17731,18933,41820,34968,108959,129378,15926,84816,75118,14235,68689,40692,19348,54726,23736,81988,21201,10467,57541,54657,27000,5404,24659,29984,25240,14576,45788,103115,131921,103304,35651,123158,114233,25433,57994,54941,18526,67975,67523,14600,86509,73008,33243,84331,101314,121774,116822,80410,31066,31451,20724,25948,81185,105546,99429,83501,87827,95550,124864,103401,77172,80095,101882,92972,100923,143054,124178,89191,91613,124273,94487,113356,87604,103710,108351,84661,89918,94054,87306,110613,104201,86401,118032,79431,86024,96271,120459,122147,104820,103221,127948,97970,130291,110124,111327,86619,115580,116808,119902,84893,113421,100924,85545,113207,116936,64338,65901,70384,127111,41728,51271,20707,93510,83630,88490,110948,115903,70031,85344,83718,102374,58524,100905,83721,74470,68624,106464,85266,68376,87296,36759,74688,86311,88002,107123,137470,91855,35647,72417,82075,84277,94494,113569,121435,124951,126877,119445,101056,74864,75072,12354,35450,48806,77735,101768,84011,79946,93968,125036,72654,78670,89803,109898,116643,115924,78670,83353,117702,87732,70186,89872,91762,102934,112022,106567,27996,135565,132912,96561,137309,37142,75131,96895,62908,67354,88759,67640,76461,85105,73556,82507,103645,96125,39475,107878,80195,75346,134751,136633,128387,101445,115794,121454,122337,89967,109288,113590,97447,72588,70311,66045,92420,72034,77786,92112,88393,123158,90327,50896,45604,22248,82061,96304,130945,103092,133541,79299,91477,102173,86113,103777,85613,77484,113141,63317,82856,78345,91487,83963],[54359,9389,14308,11956,19158,6203,9143,8736,31845,33702,8635,7970,9745,66374,8405,10732,18740,7410,8348,9701,9792,10962,15193,15867,20068,35742,7107,13878,40307,43400,31775,40033,54766,8178,24096,11914,24073,27350,28848,17943,29339,12493,33795,20234,17064,36705,23308,26096,9120,11842,18894,0,10583,2062,2550,888,1273,827,2115,6793,6442,1194,606,8186,6864,40982,0,851,770,1688,833,3618,659,2716,720,6804,5357,2598,66981,6700,3393,2852,742,2350,618,949,839,368,587,880,1433,73646,57276,11242,50292,36748,10904,42340,16037,11166,40978,17691,55120,15255,7046,42116,25128,11978,4344,16078,22842,14745,10711,28494,71225,56525,44908,21789,47888,38937,16662,24796,21696,11085,31132,25567,6203,46392,42647,14589,54054,47813,48336,64845,40484,21359,10266,13027,15574,37097,38257,41456,44682,49126,41757,50691,38833,30098,27809,32511,29648,45861,28458,45454,33445,33701,41787,29407,38725,34109,32285,32026,33050,38788,35593,32765,38045,44457,28429,37363,31529,33852,54117,55666,43789,33681,44928,50212,0,51195,45628,43839,32341,45691,42991,0,33490,44253,37981,26622,41117,65038,26371,33441,30260,53371,21462,26115,11892,42853,39285,38527,54255,30463,31350,50337,43202,48643,31555,51197,40905,50172,43817,66784,40355,41314,49367,21169,36017,0,46516,41275,51375,32102,9119,26218,25420,37283,9890,37271,49850,42271,39275,52595,37909,29833,32963,5254,11233,14236,3015,1940,1956,2193,0,2833,1882,1901,40340,47514,46035,39912,26240,21638,48465,36468,29838,29145,34831,28749,51836,38076,18155,49356,47957,39493,49970,14426,24665,30305,29890,28946,32490,24961,23979,34149,34016,32536,43587,32529,19585,39303,24710,25788,47929,52160,39367,33339,49714,44958,43693,40562,39987,35342,44846,21265,27313,24891,26329,23145,38611,30089,36148,46455,34235,30347,29278,12261,28095,42777,54836,29022,50141,29451,34432,41987,43154,35399,33989,42503,45365,37169,41478,40365,29146,21786],[35325,5207,8324,5926,13336,3895,4554,3922,31711,34052,5490,3925,5297,60333,5242,3857,16177,4366,4484,7307,4607,8252,11853,12112,13136,21151,5658,17233,38568,44718,34868,49982,35001,7533,27471,10208,27462,28530,20205,13806,30765,16269,27539,28472,10389,27954,38358,47364,6515,8561,10007,4779,44730,15168,10594,7606,17768,4199,21590,35319,27325,4267,6375,38265,60673,40871,16952,9605,4609,23253,6497,27647,6254,24272,15444,21078,20675,8701,58740,8243,24498,25021,13379,8898,19405,10963,6205,7391,8585,9888,14974,0,10776,4125,0,0,2857,0,3085,0,12252,5191,12878,0,0,5748,0,2066,0,0,6063,0,3412,15906,0,16559,44178,9100,67866,70600,3069,0,5638,4337,27916,26829,0,28861,18892,0,24113,43666,0,46429,23162,5072,0,4688,6943,42719,49964,44338,36826,33644,48381,54159,42096,26411,40373,37649,39992,38504,53206,44593,35855,43980,64063,50523,42635,36205,14370,55687,49780,32291,39728,49942,40046,32212,44451,49455,42972,41525,27031,43303,57819,40834,42557,56772,42370,66945,43393,49935,35221,48965,57767,42704,44342,50630,24307,45838,49620,37684,20843,30923,33499,30198,14018,17706,7727,45706,24058,48887,42352,41055,34080,22328,21212,51867,23990,40563,30128,0,0,36899,12348,14698,0,8490,0,19675,10958,0,84911,16032,0,31080,35197,29523,0,56857,66136,32989,54974,45233,45841,30047,27540,0,0,0,26366,43749,24137,31136,21673,44138,25474,24603,29777,40302,56241,56819,37569,47014,39423,34416,11369,0,0,22566,21694,11191,9001,11726,62886,40393,66959,14567,29312,50195,31769,37119,40820,25687,33220,49758,29860,32785,39425,36789,12073,46650,35559,31582,57198,63698,50661,44653,44546,57005,62408,47495,50982,52209,39789,33780,25151,16565,35481,24236,26024,45680,34448,55217,54441,19097,15155,6122,40967,34554,48564,56653,68273,33145,38739,33134,33698,53030,39702,15274,37495,24589,28365,28339,45777,43798],[5420,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4670,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2256,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4401,0,353,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2766,0,1540,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,909,0,0,0,0,0,0,22642,0,0,1992,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,20820,17405,0,1638,0,8623,0,0,2085,8162,7631,0,8434,7710,1508,1850,9903,0,0,0,0,0,0,0,0,0,0,0,3386,6858,0,0,0,0,0,0,2601,0,13665,1124,0,0,10159,2020,0,0,0,11274,12082,17197,8108,0,14974,188,0,3072,832,1328,2694,3600,231,4685,0,2390,8440,201,0,0,300,1357,220,0,355,10048,0,0,3637,0,12010,0,471,0,0,361,0,0,313,0,0,0,59304,0,0,33414,0,23549,20744,7631,0,0,0,5412,3084,8655,28024,12284,602,7634,0,9639,0,0,13138,50594,12536,1595,5519,3639,4999,27644,26616,1349,0,14126,6741,9884,10000,15443,0,0,0,0,0,3800,16354,1214,1123,0,0,0,0,0,3877,2958,0,0,0,8309,0,799,0,0,0,0,0,0,3721,0,0,0,0,0,0,0,0,0,3649,4891,0,0,0,2742,0,4668,0,0,39505,10283,0,0,1580,0,0,39590,223,0,0,0,5088,0,12742,0,0,21309,5355,6478,692,3613,4252,0,0,42924,3602,1569,0,0,1994,0,11349,0,15865,0,31231,8209,35428,4794,31698,61429,21083,55325,0,42386,18774,0,0,0,44784,0,0,6024,0,2898,0,0,0,4387,6509,11834,0,703,8195,0,2502,3568,0,3523,1853,1589,0,0,0,0,2813,15551,28216,52396,55621,42829,0,46187,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2263,0,0,0,0,0,0,0,0,23921,0,0,0,0,0,0,0,1327,0,2056,0,5801,0,0,0,0,0,0,0,0,0,0,0,2828,0,0,0,0,0,7775,0,10600,0,0,0,0,8487,0,0],[0,0,0,0,0,0,0,0,6448,8196,0,0,0,0,0,0,0,0,0,0,1417,0,0,0,8171,5540,2634,3143,0,11877,10392,12364,0,3603,3308,3608,7206,12800,0,2868,0,0,0,11086,2500,14062,15549,13251,1174,0,3562,9889,60649,26172,18057,5925,9088,6783,25094,25138,34201,6981,6233,39060,61662,24943,33781,4665,15070,15555,8779,36714,8003,27366,9264,58630,15081,13035,17803,9393,31241,34284,14158,16524,9958,11638,12385,9293,9119,29128,17984,0,0,0,0,0,0,0,0,0,0,0,12275,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2042,0,0,0,4459,0,1339,8010,0,1214,0,0,2483,0,8533,9949,0,15311,0,4042,1380,1495,0,15914,11467,0,0,0,15861,21365,19633,10849,16110,18920,14688,54445,28801,17573,12938,13303,11777,26954,16309,53930,19462,0,17626,14674,0,27125,25133,7786,18330,0,9533,13758,17166,17883,22392,14649,19513,14407,0,19676,12224,16064,15805,0,31923,4725,15059,36231,11429,16219,0,0,0,5871,20617,0,0,0,0,14905,0,13047,0,0,8706,17974,0,0,0,0,0,0,0,0,0,0,0,0,0,8022,0,0,0,3331,14176,20679,16352,20657,16556,0,42245,31340,17591,16234,14175,13810,1416,5180,9478,40853,50724,46316,43190,65721,68641,40550,42599,16753,18443,11713,12875,11279,9249,25663,0,0,4852,0,7525,14157,8748,0,0,20893,12820,19286,4346,15652,12499,0,0,14309,14279,17575,0,8852,13524,19582,24243,7227,18121,17310,17055,26519,19577,11936,19954,20257,18244,13508,0,15019,15337,10648,16788,14988,21693,21975,23837,10404,14380,0,19975,0,0,0,3369,12092,17871,21034,15555,13100,11689,17253,22217,0,13114,0,15871,26420,0,12210,0,15411,17774],[0,0,0,0,0,0,0,0,2294,0,0,0,0,4609,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2801,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3155,0,0,0,0,4634,3887,0,0,1289,0,0,0,3512,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5670,1449,0,0,418,0,1639,0,1374,0,0,0,0,0,0,0,32124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6571,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,61897,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3287,0,4233,0,0,0,2894,0,0,0,1911,0,0,0,2911,0,0,0,0,4639,0,0,0,0,0,2218,0,0,0,0,0,4281,0,3161,0,0,458,2379,0,0,0,12207,3505,0,0,0,0,0,0,0,0,0,0,0,0,1436,0,0,0,6307,0,0,0,0,0,0,0,0,0,0,0,8602,0,0,3823,0,0,0,17758,0,0,0,0,0,0,0,0,996,11997,12639,2677,2380,0,0,0,0,1614,4438,0,0,0,5104,2711,3856,0,0,0,0,0,0,0,0,0,71043,0,0,0,1690,4749,3195,0,0,0,1771,0,0,0,0,0,1649,0,2545,1818,0,0,0,0,0,0,0,0,0,0,8436,0,0,0,2216,0,0,0,0,16581,0,0,0,0,0,0,0,2657,0,0,2311,0,0,0,0,0,2951,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,954,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1428,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,598,0,0,1970,0,2058,0,393,0,0,0,0,0,0,883,660,833,4811,707,0,0,1760,903,644,2389,403,0,4191,0,480,500,0,2738,310,0,1213,0,0,0,0,30934,0,0,0,0,0,0,0,0,0,0,0,0,0,336,0,0,0,0,0,15515,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1325,2354,0,0,1082,1617,0,0,294,0,0,0,0,3161,1046,610,0,0,0,0,0,0,1273,0,0,0,0,0,0,0,590,838,0,670,0,0,1096,755,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4623,0,0,0,0,0,0,0,0,0,0,1726,0,0,0,0,0,0,0,0,0,0,2650,1654,2664,2425,2924,4957,2584,1067,0,0,1585,0,0,0,0,0,0,0,0,0,0,1432,0,0,0,2883,0,0,0,0,0,0,0,0,984,0,0,694,0,0,0,0,0,0,1841,0,1242,2218,0,0,1616,0,2145,1326,0,0,0,0,1846,0,1833,1109,0,0,0,0,0,0,0,0,0,1025,1302,0,0,3810,0,1306,0,0,2609,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2937,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6457,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1376,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,813,0,0,223,0,0,0,246,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,807,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6496,0,0,0,1474,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1586,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1337,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1463,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2589,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3268,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,834,0,835,0,0,0,0,0,0,0,0,0,0,507,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1379,0,0,0,0,0,0,0,0,0,0,770,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3343,0,0,0,2206,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,590,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21624,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1777,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1951,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1295,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,846,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1074,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> \u003c/th>\n      <th>sido\u003c/th>\n      <th>선거구\u003c/th>\n      <th>선거인수\u003c/th>\n      <th>투표수\u003c/th>\n      <th>새누리당\u003c/th>\n      <th>더불어민주당\u003c/th>\n      <th>노동당\u003c/th>\n      <th>무소속\u003c/th>\n      <th>국민의당\u003c/th>\n      <th>정의당\u003c/th>\n      <th>민중연합당\u003c/th>\n      <th>친반통일당\u003c/th>\n      <th>기독자유당\u003c/th>\n      <th>민주당\u003c/th>\n      <th>공화당\u003c/th>\n      <th>한나라당\u003c/th>\n      <th>고용복지연금선진화연대\u003c/th>\n      <th>녹색당\u003c/th>\n      <th>복지국가당\u003c/th>\n      <th>통일한국당\u003c/th>\n      <th>한국국민당\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

~~~{.r}
sido_party_tbl <- vote_20_df %>% dplyr::select(-선거구) %>% group_by(sido) %>% summarise_each(funs(sum))

sido_party_tbl_lng <- sido_party_tbl %>% gather(party, votes, -sido)

party_stat_tbl <- sido_party_tbl_lng %>% group_by(party) %>% summarise(vote_sum = sum(votes)) %>% arrange(desc(vote_sum)) %>% 
  dplyr::filter(!(party %in% c("선거인수", "투표수"))) %>% 
  mutate(vote_tlt = sum(vote_sum),
         pcnt = vote_sum/vote_tlt,
         cumpcnt = cumsum(pcnt),
         est_seats = round(253 * pcnt,0))

actual_seats_df <- tibble(party=c("새누리당", "더불어민주당", "국민의당", "무소속", "정의당", 
                                      "민중연합당", "노동당", "녹색당", "민주당", "친반통일당", "공화당", 
                                      "한나라당", "고용복지연금선진화연대", "기독자유당", "복지국가당", 
                                      "한국국민당", "통일한국당"),
                              act_seats = c(105, 110, 25, 11, 2, 
                                            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0))

party_stat_tbl <- bind_cols(party_stat_tbl, actual_seats_df[,2])

party_stat_tbl <- party_stat_tbl %>% mutate(win_lose = act_seats - est_seats) %>% 
  dplyr::filter(party %in% c("새누리당", "더불어민주당", "국민의당", "무소속", "정의당", "민중연합당"))

party_stat_tbl_lng <- party_stat_tbl %>% dplyr::select(party, act_seats, est_seats) %>% gather(type, value, -party)

party_stat_tbl_lng <- party_stat_tbl_lng %>% 
  mutate(party = factor(party, levels=c("새누리당", "더불어민주당", "국민의당", "무소속", "정의당", "민중연합당")),
         type = plyr::revalue(type, c(act_seats = "실제 의석수",
                                      est_seats = "비례 의석수"))) %>% 
  mutate(type = factor(type, levels=c("실제 의석수", "비례 의석수")))

# 3. 시각화 -------------------------------------------
# 3.1. 의석수 변화

ggplot(party_stat_tbl_lng, aes(party, value, fill=type, label=value)) +
  geom_bar(stat="identity", width=0.5, position ="dodge") + theme_wsj(base_family='AppleGothic') + 
  scale_y_continuous(labels = comma, limits = c(0, 150)) +
  labs(x="",y="",title="독일식 선거제도 도입시 20대 총선의석수 변화",
       subtitle="") +
  theme(legend.position="top", plot.caption=element_text(hjust=0,size=8), 
        plot.subtitle=element_text(face="italic"),
        axis.text=element_text(size=11.5), legend.title=element_blank(),
        plot.title = element_text(size=22, family="NanumGothic"),
        text=element_text(family="AppleGothic")) +
  scale_fill_manual(values=c("#999999", "#E69F00")) +
  geom_text(aes(label = value), size = 5.0, vjust = -0.5, color="#E69F00", position=position_dodge(width=0.5), hjust=0.5) +
  annotate("text", x = 1, y = 120, label = "-8", color="red", size=8) +
  annotate("text", x = 2, y = 125, label = "-16", color="blue", size=8) +
  annotate("text", x = 3, y = 55, label = "+13", color="green", size=8) +
  annotate("text", x = 4, y = 30, label = "+7", color="yellow", size=8) +
  annotate("text", x = 5, y = 20, label = "+2", color="darkgray", size=8) +
  annotate("text", x = 6, y = 20, label = "+2", color="darkgray", size=8)
~~~

<img src="fig/precinct-20-by-party-2.png" style="display: block; margin: auto;" />

### 소선구제와 독일식 비례대표제 기준 정당별 지역별 시각화

전반적으로 거대 양당은 득표율보다 많은 의석수를 갖고, 상대적으로 중소 정당은 높은 득표율을 갖고 있음에도 불구하고 
그에 걸맞지 못한 득표를 갖는 폐혜가 나타나고 있는데, 지역별로 폐혜가 나타나는 곳을 집중적으로 살펴보자.
지역을 편의상 6개 facet에 맞춰 통폐합한다.

- 수도권 : 서울, 경기, 인천
- 대전충청 : 충남, 충북, 대전, 세종
- PK : 경남, 부산
- TK : 대구, 울산, 경북
- 광주호남 : 광주, 전북, 전남
- 강원제주 : 강원, 제주


~~~{.r}
# 1. 데이터 가져오기 -------------------------------------------
## 1.1. 비례 의석수
vote_20_df <- read_excel("data/제20대_총선_종합.xlsx", sheet="Sheet1") %>% dplyr::rename("무소속"=무당파, sido=시도)

## 1.2. 실제 의석수
# url <- "https://ko.wikipedia.org/wiki/%EB%8C%80%ED%95%9C%EB%AF%BC%EA%B5%AD_%EC%A0%9C20%EB%8C%80_%EA%B5%AD%ED%9A%8C%EC%9D%98%EC%9B%90_%EC%84%A0%EA%B1%B0"
# Sys.setlocale("LC_ALL", "C")
# 
# seats_20_df <- url %>%
#   read_html() %>%
#   html_nodes(xpath='//*[@id="mw-content-text"]/table[29]') %>%
#   html_table(fill = TRUE) %>% 
#   .[[1]]
# Sys.setlocale("LC_ALL", "Korean")
# 
# names(seats_20_df) <- c("시도", "새누리당", "더불어민주당", "국민의당", "정의당", "무소속", "합　계")
# write_csv(seats_20_df, "data/총선20대_의석수.csv")
seats_20_df <- read_csv("data/총선20대_의석수.csv")
~~~



~~~{.output}
Parsed with column specification:
cols(
  시도 = col_character(),
  새누리당 = col_integer(),
  더불어민주당 = col_integer(),
  국민의당 = col_integer(),
  정의당 = col_integer(),
  무소속 = col_integer(),
  `합　계` = col_integer()
)

~~~



~~~{.r}
seats_20_df[is.na(seats_20_df)] <- 0

datatable(seats_20_df)
~~~

<!--html_preserve--><div id="htmlwidget-9531909880c53e64b688" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9531909880c53e64b688">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],["서울","인천","경기","강원","대전","세종","충남","충북","광주","전남","전북","부산","울산","대구","경남","경북","제주"],[12,4,19,6,3,0,6,5,0,1,1,12,3,8,12,13,0],[35,7,40,1,4,0,5,3,0,1,2,5,0,1,3,0,3],[2,0,0,0,0,0,0,0,8,8,7,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0],[0,2,0,1,0,1,0,0,0,0,0,1,3,3,0,0,0],[49,13,60,8,7,1,11,8,8,10,10,18,6,12,16,13,3]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> \u003c/th>\n      <th>시도\u003c/th>\n      <th>새누리당\u003c/th>\n      <th>더불어민주당\u003c/th>\n      <th>국민의당\u003c/th>\n      <th>정의당\u003c/th>\n      <th>무소속\u003c/th>\n      <th>합　계\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

~~~{.r}
# 2. 데이터 전처리 -------------------------------------------
## 2.1. 비례 의석수
vote_20_df <- vote_20_df %>% mutate(sido = str_replace_all(sido, "[0-9]", ""))

sido_party_tbl <- vote_20_df %>% dplyr::select(-선거구) %>% group_by(sido) %>% summarise_each(funs(sum))
sido_party_tbl <- sido_party_tbl %>% gather(party, votes, -sido)

sido_party_stat <- sido_party_tbl %>% group_by(sido, party) %>% summarise(vote_sum = sum(votes)) %>% arrange(desc(vote_sum)) %>% 
  dplyr::filter(!(party %in% c("선거인수", "투표수"))) %>% 
  mutate(vote_tlt = sum(vote_sum),
         pcnt = vote_sum/vote_tlt,
         cumpcnt = cumsum(pcnt),
         est_seats = 0) %>% 
  mutate(est_seats = ifelse(sido=="강원", floor(0.5 + pcnt *  8), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="경기", floor(0.5 + pcnt * 60), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="경남", floor(0.5 + pcnt * 16), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="경북", floor(0.5 + pcnt * 13), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="광주", floor(0.5 + pcnt *  8), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="대구", floor(0.5 + pcnt * 12), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="대전", floor(0.5 + pcnt *  7), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="부산", floor(0.5 + pcnt * 18), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="서울", floor(0.5 + pcnt * 49), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="세종", floor(0.5 + pcnt *  1), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="울산", floor(0.5 + pcnt *  6), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="인천", floor(0.5 + pcnt * 13), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="전남", floor(0.5 + pcnt * 10), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="전북", floor(0.5 + pcnt * 10), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="제주", floor(0.5 + pcnt *  3), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="충남", floor(0.5 + pcnt * 11), est_seats)) %>% 
  mutate(est_seats = ifelse(sido=="충북", floor(0.5 + pcnt *  8), est_seats))

sido_party_stat <- sido_party_stat %>% ungroup %>% 
  dplyr::filter(party %in% c("새누리당", "더불어민주당", "국민의당", "무소속", "정의당")) %>% 
  dplyr::select(sido, party, est_seats) 
  
## 2.2. 실제 의석수

seats_20_df <- seats_20_df %>% dplyr::select(-`합　계`) %>% gather(party, act_seats, -시도) %>% 
  dplyr::select(sido=시도, party, act_seats)

## 2.3. 비례 + 실제 의석수

precinct_20_df <- left_join(sido_party_stat, seats_20_df) %>% 
  mutate(sido = plyr::revalue(sido, c("서울" = "수도권" ,
                                      "경기" = "수도권" ,
                                      "인천" = "수도권" ,
                                      "충남" = "대전충청" ,
                                      "충북" = "대전충청" ,
                                      "대전" = "대전충청" ,
                                      "세종" = "대전충청" ,
                                      "경남" = "PK"   ,
                                      "부산" = "PK"   ,
                                      "대구" = "TK"   ,
                                      "울산" = "TK"   ,
                                      "경북" = "TK"   ,
                                      "광주" = "광주호남" ,
                                      "전북" = "광주호남" ,
                                      "전남" = "광주호남" ,
                                      "강원" = "강원제주",
                                      "제주" = "강원제주"))) %>% 
  mutate(sido=factor(sido, levels=c("TK", "PK", "광주호남", "수도권", "대전충청", "강원제주"))) %>% 
  mutate(party = plyr::revalue(party, c("새누리당" = "새누리",
                                        "더불어민주당" ="민주",
                                        "국민의당" = "국민",
                                        "정의당" = "정의",
                                        "무소속" = "무소속"))) %>% 
  mutate(party=factor(party, levels=c("새누리", "민주", "국민", "정의", "무소속")))
~~~



~~~{.output}
Joining, by = c("sido", "party")

~~~



~~~{.r}
precinct_20_df_lng <- precinct_20_df %>% 
  gather(type, value, -sido, -party) %>% 
  mutate(type = plyr::revalue(type, c("est_seats" = "비례 의석수",
                                      "act_seats" = "실제 의석수"))) %>% 
  mutate(type = factor(type, levels=c("실제 의석수", "비례 의석수")))

# 3. 시각화 -------------------------------------------

# 3.2. 시도 

ggplot(precinct_20_df_lng, 
       aes(party, value, fill=type, label=value)) +
  geom_bar(stat="identity", width=0.5, position ="dodge") + theme_wsj(base_family='NanumGothic') +
  facet_wrap(~sido) +
  theme(legend.position=c(0.5, 1.135), plot.caption=element_text(hjust=0,size=8), 
        plot.subtitle=element_text(face="italic"),
        axis.text=element_text(size=8), 
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 00, hjust = 0.5),
        plot.title = element_text(size=18, family="NanumGothic"),
        text=element_text(family="NanumGothic"),
        strip.text.x = element_text(size = 10, colour = "darkorange", angle = 0),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.3, "cm")) +
  scale_fill_manual(values=c("#999999", "#E69F00")) +
  labs(x="",y="",title="독일식 선거제도 도입시 시도별 20대 총선의석수 변화",
       subtitle="") 
~~~

<img src="fig/precinct-20-by-party-sido-2.png" style="display: block; margin: auto;" />
  
### 선거구별 당선과 낙선 비교 (상자그림)

각 정당별 평균 당선표와 낙선표를 지역별로 살펴보면, 새누리가 당선과 낙선 표차이가 가장 작고,
민주당와 국민의당, 정의당의 당선과 낙선 표차이가 크게 벌어지는 것이 확인된다.

지역별로 보면 민주당의 경우 낙선자의 표가 당선자의 표보다 평균적으로 더 많은 기현상도 광주호남에서 관찰된다.
TK지역에서는 5만표를 얻고도 낙선한 사례가 있다. 전주시병과 순천시가 그곳이다.
`precinct_20_df %>% dplyr::filter(winlose=="낙선" & sido=="광주호남" & vote >50000)`


~~~{.r}
# 1. 데이터 가져오기 -------------------------------------------
## 1.1. 실제 지역구별 득표
vote_20_df <- read_excel("data/제20대_총선_종합.xlsx", sheet="Sheet1") %>% dplyr::rename("무소속"=무당파, sido=시도)
vote_20_df <- vote_20_df %>% mutate(sido = str_replace_all(sido, "[0-9]", "")) %>% 
  dplyr::select(sido, precinct = 선거구, 새누리당, 더불어민주당, 무소속, 국민의당, 정의당) %>% 
  gather(party, vote, -sido, -precinct)

## 1.2. 당선 및 낙선 
vote_20_rank <- vote_20_df %>% group_by(sido, precinct) %>% 
  mutate(the_rank = rank(-vote, ties.method="random")) %>% 
  arrange(sido, precinct)

## 2.3. 지역 및 당선/낙선
precinct_20_df <- vote_20_rank %>% ungroup %>%  mutate(sido = plyr::revalue(sido, c("서울" = "수도권" ,
                                      "경기" = "수도권" ,
                                      "인천" = "수도권" ,
                                      "충남" = "대전충청" ,
                                      "충북" = "대전충청" ,
                                      "대전" = "대전충청" ,
                                      "세종" = "대전충청" ,
                                      "경남" = "PK"   ,
                                      "부산" = "PK"   ,
                                      "대구" = "TK"   ,
                                      "울산" = "TK"   ,
                                      "경북" = "TK"   ,
                                      "광주" = "광주호남" ,
                                      "전북" = "광주호남" ,
                                      "전남" = "광주호남" ,
                                      "강원" = "강원제주",
                                      "제주" = "강원제주"))) %>% 
  mutate(sido=factor(sido, levels=c("TK", "PK", "광주호남", "수도권", "대전충청", "강원제주"))) %>% 
  mutate(party = plyr::revalue(party, c("새누리당" = "새누리",
                                        "더불어민주당" ="민주",
                                        "국민의당" = "국민",
                                        "정의당" = "정의",
                                        "무소속" = "무소속"))) %>% 
  mutate(party=factor(party, levels=c("새누리", "민주", "국민", "정의", "무소속", "투표수"))) %>% 
  mutate(winlose = ifelse(the_rank == 1, "당선", "낙선"),
         winlose = factor(winlose, levels=c("당선", "낙선")))

# 3. 시각화 -------------------------------------------
# 3.3. 정당별
ggplot(precinct_20_df, 
       aes(party, vote, color=factor(winlose))) +
  geom_point(position = position_jitter(w = 0.3, h = 0), alpha=0.3) + theme_bw(base_family='NanumGothic') +
  scale_y_continuous(labels = comma, limits = c(0, 85000)) +
  theme(legend.position="top", plot.caption=element_text(hjust=0,size=8), 
        plot.subtitle=element_text(face="italic"),
        axis.text=element_text(size=8), 
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 00, hjust = 0.5),
        plot.title = element_text(size=18, family="NanumGothic"),
        text=element_text(family="NanumGothic"),
        strip.text.x = element_text(size = 10, colour = "black", angle = 0),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.3, "cm")) +
  scale_fill_manual(values=c("#999999", "#E69F00")) +
  labs(x="",y="",title="정당별 당선표와 낙선표 비교")
~~~

<img src="fig/precinct-winloss-by-party-1.png" style="display: block; margin: auto;" />

~~~{.r}
# 3.4. 정당별, 지역별 당선과 낙선
ggplot(precinct_20_df, 
       aes(party, vote, color=factor(winlose))) +
  geom_point(position = position_jitter(w = 0.3, h = 0), alpha=0.3) + theme_bw(base_family='NanumGothic') +
  scale_y_continuous(labels = comma, limits = c(0, 85000)) +
  facet_wrap(~sido) +
  theme(legend.position="top", plot.caption=element_text(hjust=0,size=8), 
        plot.subtitle=element_text(face="italic"),
        axis.text=element_text(size=8), 
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 00, hjust = 0.5),
        plot.title = element_text(size=18, family="NanumGothic"),
        text=element_text(family="NanumGothic"),
        strip.text.x = element_text(size = 10, colour = "black", angle = 0),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.3, "cm")) +
  scale_fill_manual(values=c("#999999", "#E69F00")) +
  labs(x="",y="",title="지역별 당선표와 낙선표 비교")
~~~

<img src="fig/precinct-winloss-by-party-2.png" style="display: block; margin: auto;" />

### 선거구별 당선과 낙선 비교 (상자그림)


~~~{.r}
# 3.1. 정당별 
ggplot(precinct_20_df, 
       aes(party, vote, color=factor(winlose))) +
  geom_boxplot() + theme_bw(base_family='NanumGothic') +
  scale_y_continuous(labels = comma, limits = c(0, 85000)) +
  theme(legend.position="top", plot.caption=element_text(hjust=0,size=8), 
        plot.subtitle=element_text(face="italic"),
        axis.text=element_text(size=8), 
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 00, hjust = 0.5),
        plot.title = element_text(size=18, family="NanumGothic"),
        text=element_text(family="NanumGothic"),
        strip.text.x = element_text(size = 10, colour = "black", angle = 0),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.3, "cm")) +
  scale_fill_manual(values=c("#999999", "#E69F00")) +
  labs(x="",y="",title="정당별 당선표와 낙선표 비교")
~~~

<img src="fig/precinct-winloss-by-party-dot-1.png" style="display: block; margin: auto;" />

~~~{.r}
# 3.2. 정당별, 지역별 당선과 낙선
ggplot(precinct_20_df, 
       aes(party, vote, color=factor(winlose))) +
  geom_boxplot() + theme_bw(base_family='NanumGothic') +
  scale_y_continuous(labels = comma, limits = c(0, 85000)) +
  facet_wrap(~sido) +
  theme(legend.position="top", plot.caption=element_text(hjust=0,size=8), 
        plot.subtitle=element_text(face="italic"),
        axis.text=element_text(size=8), 
        legend.title=element_blank(),
        axis.text.x = element_text(angle = 00, hjust = 0.5),
        plot.title = element_text(size=18, family="NanumGothic"),
        text=element_text(family="NanumGothic"),
        strip.text.x = element_text(size = 10, colour = "black", angle = 0),
        legend.key.width = unit(0.3, "cm"),
        legend.key.height = unit(0.3, "cm")) +
  scale_fill_manual(values=c("#999999", "#E69F00")) +
  labs(x="",y="",title="지역별 당선표와 낙선표 비교")
~~~

<img src="fig/precinct-winloss-by-party-dot-2.png" style="display: block; margin: auto;" />
