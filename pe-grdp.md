# 데이터 과학자와 함께 하는 제19대 대통령 선거



## 지역내총생산(GRDP) [^wiki-grdp] 변화

[^wiki-grdp]: [위키, 지역내총생산](https://ko.wikipedia.org/wiki/%EC%A7%80%EC%97%AD%EB%82%B4%EC%B4%9D%EC%83%9D%EC%82%B0)

지역내총생산(GRDP: Gross Regional Domestic Product)은 어떤기간 동안 어떠한 지역에서 생산된 상품과 서비스의 가치를 시장가격으로 평가한 수치로 
지역내총생산이 높다는 것은 그 지역 재정자립도가 높다는 것을 의미하고 반대로 지역내총생산이 낮다는 것은 재정자립도가 낮아 중앙정부의 지원이 필요하다는 것을 의미한다. 
국내에선 통계청이 1985년부터 16개 광역 시·도의 GRDP를 산출해 발표하고 있으며 지역 경제 분석과 정책 수립에 필요한 기초자료로 활용한다. 
국가로 치면 국내총생산(GDP)과 같은 개념이다.


## 지역내총생산 변화 시각화

통계청에서 1985년부터 16개 광역 시도 GRDP를 연도별로 시각화하는데 대선 기간에 맞물려서 
해당기간 GRDP가 지속적으로 줄어들고 있는 TK, PK, 강원과 GRDP가 꾸준히 증가하는 대전충청, 수도권을 중심으로 시각화한다.

### 환경설정


~~~{.r}
# 0. 환경설정 ------------------------------------------------------------------
library(DT)
library(stringr)
library(tidyverse)
library(readxl)
library(scales)
library(lubridate)
library(ggthemes)
library(extrafont)
loadfonts()
~~~

### 데이터 가져오기 및 정제

자료는 통계청 [http://kosis.kr/](http://kosis.kr/) "국내통계>주제별통계>국민계정/지역계정/국가자산>지역계정>지역소득"
에서 시도 지역내총생산(GRDP) 데이터를 가져온다.

가져온 데이터를  TK, PK, 강원과 GRDP가 꾸준히 증가하는 대전충청, 수도권을 중심으로 재정리한다.


~~~{.r}
# 1. 데이터 가져오기 ------------------------------------------------------------------
grdp <- read_excel("data/행정구역_시도_별_경제활동별_지역내총생산_20170215215258.xlsx")

# 2. 데이터 정제 ------------------------------------------------------------------

grdp <- grdp %>% slice(-1) %>% dplyr::rename(sido=`행정구역(시도)별`, "2015" = `2015 p)`) %>% dplyr::select(-경제활동별)

datatable(grdp) %>%
 formatCurrency(c(as.character(rep(1985:2015))), "", interval=3, mark=",", digit=0)
~~~

<!--html_preserve--><div id="htmlwidget-b644841bbf102ba2d16e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b644841bbf102ba2d16e">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],["전국","서울특별시","부산광역시","대구광역시","인천광역시","광주광역시","대전광역시","울산광역시","경기도","강원도","충청북도","충청남도","전라북도","전라남도","경상북도","경상남도","제주특별자치도"],["90349856","22913279","6967799","3881589","4169526","0","0","0","12553293","3726869","3102676","5826339","3427188","6511741","6783635","9681632","804290"],["105506399","27018785","7947554","4633778","4856503","0","0","0","15372741","4255538","3258618","6782220","3933317","7373963","7964741","11208955","899686"],["122679402","31702335","9248167","5537949","5648940","2269051","0","0","18515697","4878196","3629067","7527799","4311698","6118690","9394882","12799788","1097143"],["146825980","37201468","10647374","6277911","6967682","2967461","0","0","23002016","5441790","4298538","9042538","5071799","7537929","11576209","15485999","1307266"],["166257794","43077671","11537413","6996767","8051866","3439908","3728329","0","26981653","6022728","5008957","6471551","5570481","8224891","12294672","17229702","1621205"],["201737159","52333150","14330168","8625669","10125937","4388553","4694312","0","33282610","7031014","6078810","7472494","6545319","9769597","13870419","21265455","1923652"],["244996541","63548470","16946509","9959176","12964667","5233122","5876983","0","41340329","7970686","7472517","9099741","7944441","12035097","16592093","25583729","2428981"],["280976941","73166799","18198383","11038504","14351435","6080502","6779075","0","47690330","8746185","8642224","10870951","9311985","14231694","18161410","31028881","2678583"],["316557659","82828957","20134157","12036171","16174511","6836403","7733337","0","55005925","9418809","10061146","12688470","10506739","16070555","19825384","34285515","2951580"],["373112061","96067877","23157712","14214122","18658374","8177858","8657250","0","65553138","10866622","12166474","15549858","13142762","17455472","24027627","41809140","3607775"],["437585342","111002304","26988267","16514955","22837363","9685007","9937772","0","77140441","12630585","14640371","18273386","14771920","21822957","27424815","49593023","4322176"],["484291756","121526030","29592730","18399525","25105471","10893066","11141655","0","85071693","14616291","16597721","21146866","16901595","24295369","30132286","54237116","4634342"],["532638737","132303045","31696323","20178966","27708169","11795049","12275453","0","90865958","15875507","17334391","24711716","18567889","27820487","35239433","61261093","5005258"],["524913463","129736766","31590711","19147094","25673339","11023175","12151884","26388015","89974680","15580090","16980568","24814220","17540994","28207324","34522036","36744923","4837644"],["579995552","143659213","34018948","20796992","27174753","11913473","12882177","28614011","105634481","16623317","19201099","28503108","19107877","29101684","38109713","39436789","5217917"],["638029536","159730994","35660237","22639950","29278437","13213791","14393964","31052759","119873445","17445335","20342863","31895010","20562912","30659298","42796025","42902116","5582400"],["691322951","172078117","39637091","24069774","32601484","14479805","15299415","33487005","132966360","18399291","21296123","34144091","21895526","32886970","44624316","47437836","6019747"],["762788794","192248320","42568085","26150805","37330653","16047347","17085975","37033335","148014916","19848001","23024955","37971587","23370274","35074903","48308798","51934119","6776721"],["814453439","203336792","46238523","27593321","39276664","16613038","18551621","36793160","159674974","21791108","24392864","42581509","24325959","38075407","52583808","55350033","7274658"],["879128483","209445651","48849545","29799110","42631076","17679031","19702303","42688020","175038105","22848385","27766950","47680035","26058341","42034616","59410004","59550799","7946512"],["920027693","220235722","50610905","30767413","44163683","19236380","20441706","43381207","185777433","23555901","27576191","51306851","26570138","42925365","61827142","63401821","8249835"],["966660363","231223819","52357958","32275703","47054585","20614467","21377250","45154986","197973110","25022915","29761049","54335237","28064844","42951162","63294822","66709543","8488913"],["1043255209","249484652","56193270","34388093","51638293","22310449","22775080","50081523","212643897","26877722","32011158","59031320","30007052","47730444","65989788","73043911","9048557"],["1105721686","262999605","60466535","35465427","51273591","22940451","24034439","53870139","225736482","27981342","33036438","64066529","31832279","52423856","70558824","79693585","9342164"],["1151367386","273198815","60694784","36016884","53795695","23834141","25534667","52555614","237318530","29110881","34836740","71756116","34739138","51543916","72972984","83162716","10295765"],["1265146117","289718721","63737249","38579885","60708051","26400775","27631678","62852412","266562114","30628086","39469541","83166818","36632462","59901035","80839023","87419351","10898916"],["1330888239","303812518","66647601","41447963","61854353","27788989","29683859","68747862","276154982","32438497","42488940","91816385","39960114","62689437","82276360","91233284","11847095"],["1377040530","313478525","67999015","43020970","62207877","28913806","30884467","70783409","288146769","33853473","43627950","95307922","40431844","64642209","85401035","95634505","12706754"],["1430254931","318607001","70337900","44753515","64654180","29763198","31455721","68347664","313670611","35357498","47401834","99154337","42512689","62289471","89132373","99619414","13197525"],["1485504665","328660905","73673589","46523673","69500613","31294674","32798844","67018137","329558989","37170302","49790670","105002395","44242680","62456718","92697180","101028435","14086861"],["1563668478","345138040","78392070","48889293","76205929","32297199","33972978","69880625","350962812","39577655","52364151","110857420","45424907","65683545","94616925","103972772","15432157"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> \u003c/th>\n      <th>sido\u003c/th>\n      <th>1985\u003c/th>\n      <th>1986\u003c/th>\n      <th>1987\u003c/th>\n      <th>1988\u003c/th>\n      <th>1989\u003c/th>\n      <th>1990\u003c/th>\n      <th>1991\u003c/th>\n      <th>1992\u003c/th>\n      <th>1993\u003c/th>\n      <th>1994\u003c/th>\n      <th>1995\u003c/th>\n      <th>1996\u003c/th>\n      <th>1997\u003c/th>\n      <th>1998\u003c/th>\n      <th>1999\u003c/th>\n      <th>2000\u003c/th>\n      <th>2001\u003c/th>\n      <th>2002\u003c/th>\n      <th>2003\u003c/th>\n      <th>2004\u003c/th>\n      <th>2005\u003c/th>\n      <th>2006\u003c/th>\n      <th>2007\u003c/th>\n      <th>2008\u003c/th>\n      <th>2009\u003c/th>\n      <th>2010\u003c/th>\n      <th>2011\u003c/th>\n      <th>2012\u003c/th>\n      <th>2013\u003c/th>\n      <th>2014\u003c/th>\n      <th>2015\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}],"rowCallback":"function(row, data) {\nDTWidget.formatCurrency(this, row, data, 2, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 3, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 4, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 5, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 6, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 7, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 8, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 9, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 10, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 11, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 12, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 13, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 14, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 15, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 16, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 17, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 18, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 19, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 20, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 21, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 22, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 23, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 24, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 25, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 26, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 27, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 28, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 29, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 30, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 31, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 32, '', 0, 3, ',', '.', true);\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><!--/html_preserve-->

~~~{.r}
grdp <- grdp %>% mutate(sido = plyr::revalue(sido, 
                                            c( "서울특별시"   = "수도권"  ,
                                               "경기도"       = "수도권"  ,
                                               "인천광역시"   = "수도권"  ,
                                               "대전광역시"   = "대전충청",
                                               "광주광역시"   = "광주전라",
                                               "전라남도"     = "광주전라",
                                               "전라북도"     = "광주전라",
                                               "충청북도"     = "대전충청",
                                               "충청남도"     = "대전충청",
                                               "대구광역시"   = "PK"      ,
                                               "경상북도"     = "PK"      ,
                                               "울산광역시"   = "TK"      ,
                                               "부산광역시"   = "TK"      ,
                                               "경상남도"     = "TK"      ,
                                               "강원도"       = "강원"    ,
                                               "제주특별자치도" = "제주"))) 

grdp_df <- grdp %>% group_by(sido) %>% 
  mutate_at(vars(starts_with("1")),funs(as.numeric)) %>% 
  mutate_at(vars(starts_with("2")),funs(as.numeric)) %>% 
  summarise_each(funs(mean)) %>% dplyr::filter(sido!="전국") %>% 
  mutate(sido = factor(sido, levels=c("PK", "TK", "광주전라", "강원", "제주", "대전충청", "수도권")))

datatable(grdp_df) %>% 
  formatCurrency(c(as.character(rep(1985:2015))), "", interval=3, mark=",", digit=0)
~~~

<!--html_preserve--><div id="htmlwidget-462cd4a221c8dbe0c330" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-462cd4a221c8dbe0c330">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7"],["PK","TK","강원","광주전라","대전충청","수도권","제주"],[5332612,5549810.33333333,3726869,3312976.33333333,2976338.33333333,13212032.6666667,804290],[6299259.5,6385503,4255538,3769093.33333333,3346946,15749343,899686],[7466415.5,7349318.33333333,4878196,4233146.33333333,3718955.33333333,18622324,1097143],[8927060,8711124.33333333,5441790,5192396.33333333,4447025.33333333,22390388.6666667,1307266],[9645719.5,9589038.33333333,6022728,5745093.33333333,5069612.33333333,26037063.3333333,1621205],[11248044,11865207.6666667,7031014,6901156.33333333,6081872,31913899,1923652],[13275634.5,14176746,7970686,8404220,7483080.33333333,39284488.6666667,2428981],[14599957,16409088,8746185,9874727,8764083.33333333,45069521.3333333,2678583],[15930777.5,18139890.6666667,9418809,11137899,10160984.3333333,51336464.3333333,2951580],[19120874.5,21655617.3333333,10866622,12925364,12124527.3333333,60093129.6666667,3607775],[21969885,25527096.6666667,12630585,15426628,14283843,70326702.6666667,4322176],[24265905.5,27943282,14616291,17363343.3333333,16295414,77234398,4634342],[27709199.5,30985805.3333333,15875507,19394475,18107186.6666667,83625724,5005258],[26834565,31574549.6666667,15580090,18923831,17982224,81794928.3333333,4837644],[29453352.5,34023249.3333333,16623317,20041011.3333333,20195461.3333333,92156149,5217917],[32717987.5,36538370.6666667,17445335,21478667,22210612.3333333,102960958.666667,5582400],[34347045,40187310.6666667,18399291,23087433.6666667,23579876.3333333,112548653.666667,6019747],[37229801.5,43845179.6666667,19848001,24830841.3333333,26027505.6666667,125864629.666667,6776721],[40088564.5,46127238.6666667,21791108,26338134.6666667,28508664.6666667,134096143.333333,7274658],[44604557,50362788,22848385,28590662.6666667,31716429.3333333,142371610.666667,7946512],[46297277.5,52464644.3333333,23555901,29577294.3333333,33108249.3333333,150058946,8249835],[47785262.5,54740829,25022915,30543491,35157845.3333333,158750504.666667,8488913],[50188940.5,59772901.3333333,26877722,33349315,37939186,171255614,9048557],[53012125.5,64676753,27981342,35732195.3333333,40379135.3333333,180003226,9342164],[54494934,65471038,29110881,36705731.6666667,44042507.6666667,188104346.666667,10295765],[59709454,71336337.3333333,30628086,40978090.6666667,50089345.6666667,205662962,10898916],[61862161.5,75542915.6666667,32438497,43479513.3333333,54663061.3333333,213940617.666667,11847095],[64211002.5,78138976.3333333,33853473,44662619.6666667,56606779.6666667,221277723.666667,12706754],[66942944,79434992.6666667,35357498,44855119.3333333,59337297.3333333,232310597.333333,13197525],[69610426.5,80573387,37170302,45998024,62530636.3333333,242573502.333333,14086861],[71753109,84081822.3333333,39577655,47801883.6666667,65731516.3333333,257435593.666667,15432157]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> \u003c/th>\n      <th>sido\u003c/th>\n      <th>1985\u003c/th>\n      <th>1986\u003c/th>\n      <th>1987\u003c/th>\n      <th>1988\u003c/th>\n      <th>1989\u003c/th>\n      <th>1990\u003c/th>\n      <th>1991\u003c/th>\n      <th>1992\u003c/th>\n      <th>1993\u003c/th>\n      <th>1994\u003c/th>\n      <th>1995\u003c/th>\n      <th>1996\u003c/th>\n      <th>1997\u003c/th>\n      <th>1998\u003c/th>\n      <th>1999\u003c/th>\n      <th>2000\u003c/th>\n      <th>2001\u003c/th>\n      <th>2002\u003c/th>\n      <th>2003\u003c/th>\n      <th>2004\u003c/th>\n      <th>2005\u003c/th>\n      <th>2006\u003c/th>\n      <th>2007\u003c/th>\n      <th>2008\u003c/th>\n      <th>2009\u003c/th>\n      <th>2010\u003c/th>\n      <th>2011\u003c/th>\n      <th>2012\u003c/th>\n      <th>2013\u003c/th>\n      <th>2014\u003c/th>\n      <th>2015\u003c/th>\n    \u003c/tr>\n  \u003c/thead>\n\u003c/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatCurrency(this, row, data, 2, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 3, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 4, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 5, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 6, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 7, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 8, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 9, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 10, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 11, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 12, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 13, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 14, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 15, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 16, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 17, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 18, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 19, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 20, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 21, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 22, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 23, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 24, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 25, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 26, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 27, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 28, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 29, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 30, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 31, '', 0, 3, ',', '.', true);\nDTWidget.formatCurrency(this, row, data, 32, '', 0, 3, ',', '.', true);\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><!--/html_preserve-->

~~~{.r}
grdp_df_lng <- grdp_df %>% gather(year, grdp, -sido)

grdp_df_lng <- grdp_df_lng %>% 
  group_by(year) %>% 
  mutate(grdp_sum = sum(grdp)) %>%
  group_by(sido) %>% 
  mutate(pcnt = grdp / grdp_sum,
         year = ymd(paste0(year, "-01-01"))) 
~~~

### 데이터 시각화

지역내총생산 변화를 시각적으로 가장 잘 나타낼 수 있는 방법 중 하나로 시간의 흐름에 따른 시계열 그림을 `ggplot`으로 시각화한다.


~~~{.r}
# 3. 시각화 ------------------------------------------------------------------
dlist <- unique(grdp_df_lng$year)

ggplot(grdp_df_lng , aes(year, pcnt, group=sido, color=sido, label=sido)) +
  geom_point() +
  geom_line() +
  theme_fivethirtyeight(base_family="AppleGothic") +
  coord_flip() +
  geom_text(data=grdp_df_lng %>% dplyr::filter(year==tail(dlist,1)), vjust=-1, family="AppleGothic") +
  scale_x_date(breaks=seq(dlist[1], tail(dlist,1)+years(1), "5 year"),
               date_labels="%Y",limits=c(dlist[1],tail(dlist,1)+years(1)))+ 
  scale_y_continuous(labels=percent) +
  labs(x="",y="",title="지역내총생산(GRDP) 기여비율 변화",
       caption="\n 자료출처: 통계청(국내통계>주제별통계>국민계정/지역계정/국가자산>지역계정>지역소득), http://kosis.kr/",
       subtitle="PK, TK, 광주전라, 강원 對 대전충청, 수도권, 제주") +
  theme(legend.position="none", plot.caption=element_text(hjust=0,size=9),plot.subtitle=element_text(face="italic"),
        axis.text=element_text(size=11))
~~~

<img src="fig/grdp-ggplot-1.png" style="display: block; margin: auto;" />
